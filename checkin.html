<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ¬¡å›ãƒ‰ãƒªãƒ³ã‚¯å‰²å¼•</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;
      background:#f6f6f6;
      margin:0;
      padding:14px 12px 18px;
      text-align:center;
      color:#111;
    }
    .wrap{max-width:640px;margin:0 auto;}
    .card{
      background:#fff;
      border-radius:26px;
      padding:20px 16px 18px;
      box-shadow:0 10px 30px rgba(0,0,0,.07);
    }
    .title{
      font-size:24px;
      font-weight:900;
      margin-bottom:6px;
    }
    .sub{font-size:18px;font-weight:900;margin-bottom:6px;}
    .lead{font-size:18px;font-weight:900;margin:4px 0 6px;}
    .note{
      background:#fff3cd;
      border-radius:14px;
      padding:12px;
      font-size:16px;
      font-weight:900;
      margin:6px 0;
      line-height:1.35;
    }
    .muted{font-size:14px;color:#666;margin:4px 0;}
    .codeBig{
      font-size:30px;
      font-weight:900;
      letter-spacing:.08em;
      margin:8px 0 0;
    }
    .codeLine{
      font-size:14px;
      font-weight:800;
      color:#666;
      margin-bottom:6px;
    }
    .qr{
      width:100%;
      max-width:260px;
      margin:4px auto 0;
      display:block;
    }
    .footer{font-size:14px;color:#888;margin-top:6px;}
    .mono{font-family:ui-monospace,Menlo,Consolas,monospace;}
  </style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="title">ğŸ« æ¬¡å›ãƒ‰ãƒªãƒ³ã‚¯å‰²å¼•</div>
    <div class="sub">2/24 LIVE å†æ¥å ´ç‰¹å…¸</div>
    <div class="lead">ã“ã®ç”»é¢ã‚’ã‚¹ã‚¯ã‚·ãƒ§ä¿å­˜ã—ã¦ãã ã•ã„</div>

    <div class="note">
      2/24æ¥å ´æ™‚ã«ã“ã®ç”»é¢ã‚’è¦‹ã›ã‚‹ã¨<br>
      <strong>ãƒ‰ãƒªãƒ³ã‚¯å‰²å¼•ï¼ˆ1å›ï¼‰</strong>ãŒä½¿ãˆã¾ã™ ğŸº
    </div>

    <div class="muted">â€» ã‚¹ã‚¿ãƒƒãƒ•ãŒèª­ã¿å–ã‚Šã¾ã™</div>

    <div class="codeBig mono" id="codeBig">----</div>
    <div class="codeLine" id="codeLine">code: ----</div>

    <img id="qr" class="qr" alt="ã‚¹ã‚¿ãƒƒãƒ•èª­ã¿å–ã‚Šç”¨QR">
    <div class="footer">ã“ã®ç”»é¢ã¯å†ç™ºè¡Œã§ãã¾ã›ã‚“</div>
  </div>
</div>

<script>
  // spotï¼ˆ2æ–‡å­—ï¼‰
  const params = new URLSearchParams(location.search);
  let spot = (params.get("spot") || "uk").toLowerCase().slice(0,2);

  const alphabet = "23456789ABCDEFGHJKLMNPQRSTUVWXYZ";
  const rand4 = () => {
    let s = "";
    for(let i=0;i<4;i++) s += alphabet[Math.floor(Math.random()*alphabet.length)];
    return s;
  };

  const uid = rand4();
  const token = uid + spot;

  // ç™ºè¡Œæ™‚åˆ»ï¼ˆUnixåˆ† â†’ base36ï¼‰
  const issuedMin = Math.floor(Date.now() / 60000);
  const t = issuedMin.toString(36);

  const base = location.origin + location.pathname.replace(/[^\/]+$/, "");
  const redeemUrl =
    `${base}redeem.html?c=${encodeURIComponent(token)}&t=${t}`;

  document.getElementById("qr").src =
    "https://barcode.tec-it.com/barcode.ashx" +
    "?data=" + encodeURIComponent(redeemUrl) +
    "&code=QRCode";

  document.getElementById("codeBig").textContent = uid.toLowerCase();
  document.getElementById("codeLine").textContent = `code: ${uid.toLowerCase()}-${spot}`;
</script>
</body>
</html>
